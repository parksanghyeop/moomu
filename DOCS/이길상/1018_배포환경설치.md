# 배포 환경 설치

## 0. git clone

---

- remote git 저장소에 존재하는 프로젝트를 가져올 필요가 있다.

```bash
# 프로젝트 clone. 인증이 필요할경우 remote 특성별로 별도 진행
git clone [remote git url]

# credential 캐시 설정
git config credential.helper store
```

## 1. React

---

- 리액트를 배포하기 위해서는 빌드를 진행해야 한다.

```bash
# 디렉토리 이동
cd [react project dir]

# 빌드
npm i
npm run build #react-scripts build
```

- node 환경만으로 배포를 진행하고 싶을 경우 다음과 같이 진행한다.

```bash
# serve로 배포
npx serve -s build

# http 80포트 사용
npx serve -s build -l 80
```

- 세션 종료시에도 배포를 원할 경유 nohup 설정을 해주면 된다.

## 2. React + nginx

---

- nginx는 웹 서버 프레임워크로, 리버스 프록시, 캐싱과 로드밸런싱이 가능하다.

```bash
# 설정 파일 수정
# default가 이미 존재한다. 수정하여 .conf로 만들거나 삭제하고 새로 만들어준다.
sudo vi /etc/nginx/sites-available/[파일명].conf

# 입력 내용
server {
  listen 80;  #http 포트
  
  location / {
    root	[리액트 빌드 폴더];
    index	index.html index.htm;
    try_files 	$uri $uri/ /index.html;
  }
}

# nginx/sites-enabled에 심볼릭 링크를 만들어준다
$..nginx: sudo ln -s sites-available/[파일명].conf sites-enabled/[파일명].conf

# nginx 재시작
sudo systemctl stop nginx
sudo systemctl start nginx
sudo systemctl status nginx
```

- 우분투 방화벽 설정을 켜두었다면 80포트를 열어줘야 한다.

## 3. FastAPI

---

- dockerfile 작성

```bash
#/requirements.txt
uvicorn
fastapi

# /fastapiDF 작성
pip install requirements.txt
uvicorn main:app --host=0.0.0.0 --port=8000
```
